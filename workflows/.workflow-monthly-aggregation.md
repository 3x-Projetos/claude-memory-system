# Workflow: Monthly Aggregation

**Propósito**: Agregar resumos semanais em resumo mensal para máxima economia de tokens e visão estratégica.

**Quando executar**:
- Automaticamente ao detectar mês sem registro (via `/continue` ou `/new`)
- Manualmente via `/aggregate month`
- Recomendado: Primeiro dia do mês seguinte

---

## Input
- **Arquivos**: Todos os resumos em `logs/weekly/` do mês alvo
- **Período**: ~4-5 semanas do mês
- **Formato**: `YYYY.MM.weekN.md`

## Output
- **Arquivo**: `logs/monthly/YYYY.MM.md`
- **Tamanho alvo**: ~30 linhas (vs ~400-500 linhas em 4 resumos semanais)
- **Redução esperada**: ~93% vs diários, ~85% vs semanais

---

## Processo

### 1. Identificação do Mês
- Validar existência de resumos semanais para o mês
- Identificar semanas parciais (início/fim de mês)

### 2. Leitura dos Resumos Semanais
- Ler todos os `logs/weekly/YYYY.MM.*.md` do mês
- Extrair informações de alto nível

### 3. Análise e Agregação de Alto Nível
Claude deve agregar as seguintes seções:

#### a) Realizações do Mês
- Projetos completados
- Features principais implementadas
- Milestones alcançados
- Problemas complexos resolvidos

#### b) Padrões e Tendências
- Tecnologias/frameworks mais utilizados
- Tipos de tarefas recorrentes
- Áreas de foco (dev/docs/infra/learning)

#### c) Tecnologias e Ferramentas
- Novas tecnologias adotadas
- Ferramentas configuradas
- Stack tech predominante

#### d) Métricas Mensais (agregadas)
- Total de sessões Claude CLI
- Total de commits Git
- Total de arquivos modificados
- Horas estimadas

**Holísticas (tendências)**:
- Performance: Evolução da velocity
- Cognitive Load: Complexidade média das tarefas
- Well-being: Trajetória de satisfação
- Learning: Curva de aprendizado
- Autonomy: Independência crescente

#### e) Decisões Arquiteturais Importantes
- Top 3-5 decisões do mês
- Impacto de cada decisão

#### f) Aprendizados Principais
- Top 5 aprendizados
- Problemas difíceis resolvidos

#### g) Próximos Passos (Mês Seguinte)
- Foco planejado
- Projetos a iniciar/continuar
- Áreas de crescimento

### 4. Formatação do Resumo
```markdown
# Resumo Mensal - YYYY.MM
**Mês**: [Nome do Mês] de YYYY
**Semanas agregadas**: N

---

## Realizações do Mês
- [Projeto X] completado
- [Feature Y] implementada
- [Milestone Z] alcançado

---

## Padrões e Tendências
- **Foco principal**: [área]
- **Tecnologias dominantes**: [tech stack]
- **Tipo de trabalho**: X% dev, Y% docs, Z% infra, W% learning

---

## Tecnologias e Ferramentas
- [Tech nova 1]: [contexto de uso]
- [Ferramenta 2]: [configurada/adotada]

---

## Métricas Mensais
- Sessões: ~X
- Commits: ~Y
- Arquivos modificados: ~Z
- Horas: ~W

**Holísticas**:
- Performance: [tendência]
- Cognitive Load: [tendência]
- Well-being: [tendência]
- Learning: [curva]
- Autonomy: [evolução]

---

## Decisões Arquiteturais Importantes
1. [Decisão importante]: [Impacto]
2. [Decisão importante]: [Impacto]

---

## Aprendizados Principais
1. [Aprendizado chave]
2. [Problema difícil resolvido]

---

## Próximos Passos (Mês Seguinte)
- [Foco planejado]
- [Projeto a iniciar]
- [Área de crescimento]

---

*Resumo gerado automaticamente a partir de resumos semanais*
```

---

## Execução via Comando

**Uso**:
```
/aggregate month [YYYY] [MM]
```

**Exemplos**:
- `/aggregate month` → Agrega último mês completo
- `/aggregate month 2025 11` → Agrega novembro de 2025

**Comando instrui Claude**:
1. Identificar mês alvo
2. Ler todos os resumos semanais do mês
3. Executar este workflow
4. Criar arquivo `logs/monthly/YYYY.MM.md`
5. Atualizar `.session-state.md` (marcar mês como agregado)

---

## Validação

**Checklist pós-agregação**:
- [ ] Arquivo criado em `logs/monthly/`
- [ ] Tamanho ~30 linhas
- [ ] Captura realizações principais
- [ ] Tendências identificadas
- [ ] Decisões críticas preservadas
- [ ] Aprendizados chave documentados

---

## Notas Importantes

- **Visão estratégica**: Foco em impacto, não detalhes
- **Tendências sobre eventos**: O que persistiu ao longo do mês
- **Top N em vez de tudo**: Top 3-5 itens mais importantes
- **Contexto suficiente**: Cada item deve ser auto-explicativo

---

## Exemplo de Uso no Carregamento

Quando `/continue` executa, Claude:
1. Lê `.session-state.md` (50 linhas)
2. Lê `~/.claude-memory/global-memory.safe.md` (~200 linhas)
3. Lê `logs/monthly/2025.11.md` (30 linhas) - contexto do mês
4. Lê `logs/weekly/2025.11.week46.md` (100 linhas) - última semana
5. **Total: ~380 linhas** vs **~5.000 linhas** de logs diários brutos

**Economia: ~92%**

---

*Este workflow é parte do Sistema de Memória Hierárquica - Máxima economia de tokens*
